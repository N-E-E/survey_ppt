import{d as A,t as k,at as E,_ as x,y,C as b,o as B,b as D,f as I}from"../modules/vue-CTgvBLQu.js";import{p as K}from"./chunk-YNRNLEBD-DKdYZNHt.js";import{$ as N,a0 as T,a1 as q,b as w}from"../index-ChUrun_E.js";import{u as P}from"./context-CIVgM6Zk.js";const R=A({__name:"KaTexBlockWrapper",props:{ranges:{type:Array,default:()=>[]},finally:{type:[String,Number],default:"last"},startLine:{type:Number,default:1},at:{type:[String,Number],default:"+1"}},setup(v){const e=v,{$clicksContext:a}=P(),l=k(),u=N();return E(()=>{a.unregister(u)}),x(()=>{var m;if(!a||!((m=e.ranges)!=null&&m.length))return;const{start:o,end:f,delta:S}=a.resolve(e.at,e.ranges.length-1);a.register(u,{max:f,delta:S});const g=y(()=>Math.max(0,a.current-o+1)),p=y(()=>e.finally==="last"?e.ranges.at(-1):e.finally.toString());b(()=>{if(!l.value)return;let i=e.ranges[g.value]??p.value;const d=i==="hide";l.value.classList.toggle(T,d),d&&(i=e.ranges[g.value+1]??p.value);const h=l.value.querySelectorAll(".mtable > [class*=col-align]");if(!h)return;const C=Array.from(h).map(r=>Array.from(r.querySelectorAll(":scope > .vlist-t > .vlist-r > .vlist > span > .mord"))),s=[];for(const r of C)r.forEach((n,t)=>{n&&(Array.isArray(s[t])?s[t].push(n):s[t]=[n])});const _=e.startLine,L=K(s.length+_-1,i);s.forEach((r,n)=>{const t=L.includes(n+_);r.forEach(c=>{c.classList.toggle(q,!0),c.classList.toggle("highlighted",t),c.classList.toggle("dishonored",!t)})})})}),(o,f)=>(B(),D("div",{ref_key:"el",ref:l,class:"slidev-katex-wrapper"},[I(o.$slots,"default")],512))}}),G=w(R,[["__file","D:/暑研/梁胜文老师/huawei/survey/node_modules/@slidev/client/builtin/KaTexBlockWrapper.vue"]]);export{G as _};
